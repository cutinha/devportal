# A file of tests to be run with shelltest.
#
# See https://github.com/simonmichael/shelltestrunner
#
# On a Mac, install with `brew install shelltest`
#
# For the moment there's only one test file for all the tests - this may change.
#
# Run with:
#
#    $ shelltest --diff .vale/tests/shelltest.test
#
# NOTE that the order of output of error messages from vale does not seem to be
# deterministic. This has been evident with `.vale/tests/bad.rst`.
# The simplest solution for our purposes is to run the result through `sort`,
# although then we lost the ability to test the return code - although for
# these tests I don't think I'm concerned with testing the vale return code.

# ---------------------------------------------------------------
# General checks

$ vale --output=line .vale/tests/good.rst
>=0


$ vale --output=line .vale/tests/bad.rst | sort
>
.vale/tests/bad.rst:10:1:Aiven.aiven_spelling:'influxdb' seems to be a typo
.vale/tests/bad.rst:11:1:Aiven.aiven_spelling:'kakfa' seems to be a typo
.vale/tests/bad.rst:11:1:Aiven.common_replacements:Use 'Kafka' instead of 'kakfa'.
.vale/tests/bad.rst:12:1:Aiven.aiven_spelling:'kafka' seems to be a typo
.vale/tests/bad.rst:12:1:Aiven.common_replacements:Use 'Kafka' instead of 'kafka'.
.vale/tests/bad.rst:13:1:Aiven.aiven_spelling:'multicloud' seems to be a typo
.vale/tests/bad.rst:13:1:Aiven.common_replacements:Use 'multi-cloud' instead of 'multicloud'.
.vale/tests/bad.rst:14:1:Aiven.aiven_spelling:'postgesql' seems to be a typo
.vale/tests/bad.rst:14:1:Aiven.common_replacements:Use 'PostgreSQL' instead of 'postgesql'.
.vale/tests/bad.rst:15:1:Aiven.aiven_spelling:'postgres' seems to be a typo
.vale/tests/bad.rst:15:1:Aiven.common_replacements:Use 'PostgreSQL' instead of 'postgres'.
.vale/tests/bad.rst:16:1:Aiven.common_replacements:Use 'PostgreSQL' instead of 'postgreSql'.
.vale/tests/bad.rst:17:1:Aiven.aiven_spelling:'timeseries' seems to be a typo
.vale/tests/bad.rst:17:1:Aiven.common_replacements:Use 'time series' instead of 'timeseries'.
.vale/tests/bad.rst:21:8:Aiven.first_Flink_is_registered:At least one 'Flink' must be marked as ®
.vale/tests/bad.rst:5:1:Aiven.aiven_spelling:'clickhouse' seems to be a typo
.vale/tests/bad.rst:5:1:Aiven.common_replacements:Use 'ClickHouse' instead of 'clickhouse'.
.vale/tests/bad.rst:6:1:Aiven.aiven_spelling:'Clickhouse' seems to be a typo
.vale/tests/bad.rst:6:1:Aiven.common_replacements:Use 'ClickHouse' instead of 'Clickhouse'.
.vale/tests/bad.rst:8:1:Aiven.common_replacements:Use 'Flink' instead of 'flick'.
.vale/tests/bad.rst:9:1:Aiven.common_replacements:Use 'InfluxDB' instead of 'influx'.
>=0


# ---------------------------------------------------------------
# Require a registered/trademarked occurrence of a term

# PROBLEMS:
# 1. The sentence case is known to be a problem - see below for more.
# 2. I'm still exploring that Clickhouse error in the `good` file.
#
$ vale --output=line .vale/tests/first_ref_good.rst | sort
>
.vale/tests/first_ref_good.rst:1:1:Aiven.capitalization_headings:'This is a Flink® title' should be in sentence case
.vale/tests/first_ref_good.rst:8:40:Aiven.first_ClickHouse_is_registered:At least one 'ClickHouse' must be marked as ®
>=0

$ vale --output=line .vale/tests/first_ref_bad.rst | sort
>
.vale/tests/first_ref_bad.rst:1:11:Aiven.first_Flink_is_registered:At least one 'Flink' must be marked as ®
.vale/tests/first_ref_bad.rst:1:1:Aiven.capitalization_headings:'This is a Flink title' should be in sentence case
.vale/tests/first_ref_bad.rst:4:42:Aiven.first_Flink_is_registered:At least one 'Flink' must be marked as ®
.vale/tests/first_ref_bad.rst:6:43:Aiven.first_Flink_is_registered:At least one 'Flink' must be marked as ®
.vale/tests/first_ref_bad.rst:8:19:Aiven.first_Kafka_is_registered:At least one 'Kafka' must be marked as ®
.vale/tests/first_ref_bad.rst:8:39:Aiven.first_ClickHouse_is_registered:At least one 'ClickHouse' must be marked as ®
.vale/tests/first_ref_bad.rst:8:65:Aiven.first_ClickHouse_is_registered:At least one 'ClickHouse' must be marked as ®
>=0

# ---------------------------------------------------------------
# Headings are to be sentence cased
# Note that these are warnings, not errors, and so vale's exit status code is 0

# PROBLEMS: I know I have some problem with sentence casing in the `good` file.
#
$ vale --output=line .vale/tests/sentence_case_title_good.rst | sort
>
.vale/tests/sentence_case_title_good.rst:39:1:Aiven.capitalization_headings:'Multiple things with ® should work, such as Aiven® and Flink®' should be in sentence case
.vale/tests/sentence_case_title_good.rst:46:1:Aiven.capitalization_headings:'But not Flink®' should be in sentence case
.vale/tests/sentence_case_title_good.rst:51:1:Aiven.capitalization_headings:'But not Aiven®' should be in sentence case
.vale/tests/sentence_case_title_good.rst:56:1:Aiven.capitalization_headings:'Not Aiven®' should be in sentence case
.vale/tests/sentence_case_title_good.rst:61:1:Aiven.capitalization_headings:'Not Aiven, something' should be in sentence case
>=0


$ vale --output=line .vale/tests/sentence_case_title_bad.rst | sort
>
.vale/tests/sentence_case_title_bad.rst:14:1:Aiven.capitalization_headings:'We do not allow Random Mixed Case' should be in sentence case
.vale/tests/sentence_case_title_bad.rst:4:1:Aiven.capitalization_headings:'This is a subtitle Not in sentence case by Tony' should be in sentence case
.vale/tests/sentence_case_title_bad.rst:9:1:Aiven.capitalization_headings:'We do not allow How To in a title' should be in sentence case
>=0
